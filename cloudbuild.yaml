steps:
# Install
- name: node:10.15.1
  entrypoint: npm
  args: ['install']

- name: 'npm'
  args: ['install']
# Lint
- name: 'gcr.io/cloud-builders/npm:current'
  args: ['run', 'lint']
# test
# - name: 'gcr.io/cloud-builders/npm:current'
#   args: ['run', 'test:headless']
# Build
- name: 'gcr.io/cloud-builders/npm:current'
  args: ['run', 'build-${_ENV}']
# Deploy
- name: 'gcr.io/$PROJECT_ID/firebase'
  args: ['use' , '${_FIREBASE_PROJECT}', '--token', '${_FIREBASE_TOKEN}' ]
- name: 'gcr.io/$PROJECT_ID/firebase'
  args: ['deploy','--debug', '--token', '${_FIREBASE_TOKEN}' , '--only', 'hosting:${_FIREBASE_TARGET}']
