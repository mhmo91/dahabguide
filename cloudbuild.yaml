steps:
# Install
- name: 'gcr.io/cloud-builders/npm:current'
  args: ['install']
# Lint
- name: 'gcr.io/cloud-builders/npm:current'
  args: ['run', 'lint']
# test
# - name: 'gcr.io/cloud-builders/npm:current'
#   args: ['run', 'test:headless']
# Build
- name: 'gcr.io/cloud-builders/npm:current'
  args: ['run', 'build-prod', '--c=${_ENV}']
# Deploy
- name: 'gcr.io/$PROJECT_ID/firebase'
  args: ['use' , '${_FIREBASE_PROJECT}', '--token', '${_FIREBASE_TOKEN}' ]
- name: 'gcr.io/$PROJECT_ID/firebase'
  args: ['deploy','--debug', '--token', '${_FIREBASE_TOKEN}' , '--only', 'hosting:${_FIREBASE_TARGET}']
